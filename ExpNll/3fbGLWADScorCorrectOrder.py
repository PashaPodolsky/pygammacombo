from changeVarOrderInCor import *
np.set_printoptions(precision=3)
np.set_printoptions(linewidth=200)

# Bring the order of LHCb-ANA-2014-071 to that used in gammacombo
# numbers where formatted by 3fbGLWADScorConvertToCode.sh

##
## C++ printout
##
def printCppMatrix(v):
    column = v[:,0]
    for iRow in xrange(0,len(column)):
        row = np.asarray(v)[iRow,:]
        print " , ".join(["%5.2f"%(entry) for entry in row])+" ,"


# 2-body stat
cor = np.matrix([
[1.0     , 0.0023  , 0.0025  , -0.1747 , -0.3084 , 0.0002  , -0.005  , -0.0014 , -0.0023 , -0.1126 , 0.0113  , 0.0008  , 0.0001   ], # $R_{K/pi}^{Kpi}$    
[0.0023  , 1.0     , -0.2808 , 0.0     , -0.0004 , -0.192  , -0.0484 , -0.3313 , -0.0829 , 0.0007  , 0.0004  , -0.0269 , -0.0523  ], # $A_{B_{u}}$         
[0.0025  , -0.2808 , 1.0     , -0.0001 , -0.0001 , 0.0537  , 0.0146  , 0.0926  , 0.0249  , -0.0001 , -0.0001 , 0.0077  , 0.0136   ], # $A_{K}^{Kpi}$       
[-0.1747 , 0.0     , -0.0001 , 1.0     , 0.0619  , -0.0036 , -0.0312 , 0.0     , -0.0001 , 0.0255  , -0.0026 , 0.0011  , 0.0      ], # $R_{CP}^{pipi}$     
[-0.3084 , -0.0004 , -0.0001 , 0.0619  , 1.0     , 0.0001  , -0.0002 , -0.0014 , -0.0135 , 0.0399  , -0.0058 , 0.0005  , 0.0002   ], # $R_{CP}^{KK}$       
[0.0002  , -0.192  , 0.0537  , -0.0036 , 0.0001  , 1.0     , -0.0421 , 0.0636  , 0.0158  , -0.0001 , -0.0    , 0.0052  , 0.0101   ], # $A_{pi}^{pipi}$     
[-0.005  , -0.0484 , 0.0146  , -0.0312 , -0.0002 , -0.0421 , 1.0     , 0.016   , 0.0044  , -0.0009 , -0.0001 , 0.0011  , 0.0025   ], # $A_{K}^{pipi}$      
[-0.0014 , -0.3313 , 0.0926  , 0.0     , -0.0014 , 0.0636  , 0.016   , 1.0     , -0.0128 , -0.0001 , -0.0002 , 0.0089  , 0.0174   ], # $A_{pi}^{KK}$       
[-0.0023 , -0.0829 , 0.0249  , -0.0001 , -0.0135 , 0.0158  , 0.0044  , -0.0128 , 1.0     , -0.0002 , 0.0001  , 0.0023  , 0.0043   ], # $A_{K}^{KK}$        
[-0.1126 , 0.0007  , -0.0001 , 0.0255  , 0.0399  , -0.0001 , -0.0009 , -0.0001 , -0.0002 , 1.0     , -0.0238 , 0.1042  , 0.0158   ], # $R_{ADS(K)}^{piK}$  
[0.0113  , 0.0004  , -0.0001 , -0.0026 , -0.0058 , -0.0    , -0.0001 , -0.0002 , 0.0001  , -0.0238 , 1.0     , -0.0036 , -0.0409  ], # $R_{ADS(pi)}^{piK}$ 
[0.0008  , -0.0269 , 0.0077  , 0.0011  , 0.0005  , 0.0052  , 0.0011  , 0.0089  , 0.0023  , 0.1042  , -0.0036 , 1.0     , -0.0492  ], # $A_{ADS(K)}^{piK}$  
[0.0001  , -0.0523 , 0.0136  , 0.0     , 0.0002  , 0.0101  , 0.0025  , 0.0174  , 0.0043  , 0.0158  , -0.0409 , -0.0492 , 1.0      ], # $A_{ADS(pi)}^{piK}$
])
print "2-body stat (ANA order)"
printCppMatrix(cor)
print "2-body stat (gammacombo order)"
cor = changeVarOrderInCor(cor,[1, 4, 5, 2, 3, 8, 6, 9, 7, 10, 12, 11, 13])
printCppMatrix(cor)

# 2-body syst
cor = np.matrix([
[1.00    , 0.66    , -0.40   , 0.14    , 0.02    , -0.07   , -0.07   , -0.04   , 0.06    , 0.67    , -0.72   , 0.15    , -0.31    ], # 1 $A_{K}^{KK}$        
[0.66    , 1.00    , -0.01   , 0.16    , -0.06   , -0.14   , -0.09   , -0.16   , 0.20    , 0.54    , -0.59   , 0.21    , -0.22    ], # 2 $A_{K}^{pipi}$      
[-0.40   , -0.01   , 1.00    , 0.22    , -0.20   , -0.03   , -0.18   , -0.12   , 0.34    , 0.01    , 0.20    , 0.17    , 0.46     ], # 3 $A_{pi}^{KK}$       
[0.14    , 0.16    , 0.22    , 1.00    , -0.11   , -0.38   , -0.15   , -0.24   , -0.05   , 0.08    , -0.11   , 0.10    , 0.06     ], # 4 $A_{pi}^{pipi}$     
[0.02    , -0.06   , -0.20   , -0.11   , 1.00    , 0.65    , 0.00    , -0.02   , -0.00   , -0.11   , -0.53   , -0.03   , -0.08    ], # 5 $A_{K}^{Kpi}$       
[-0.07   , -0.14   , -0.03   , -0.38   , 0.65    , 1.00    , 0.00    , 0.00    , 0.00    , -0.14   , -0.33   , 0.01    , -0.03    ], # 6 $A_{B_{u}}$         
[-0.07   , -0.09   , -0.18   , -0.15   , 0.00    , 0.00    , 1.00    , 0.26    , 0.03    , -0.05   , 0.07    , -0.13   , -0.09    ], # 7 $R_{K/pi}^{Kpi}$    
[-0.04   , -0.16   , -0.12   , -0.24   , -0.02   , 0.00    , 0.26    , 1.00    , 0.48    , -0.07   , 0.01    , 0.13    , 0.06     ], # 8 $R_{CP}^{pipi}$     
[0.06    , 0.20    , 0.34    , -0.05   , -0.00   , 0.00    , 0.03    , 0.48    , 1.00    , -0.02   , -0.22   , 0.50    , 0.37     ], # 9 $R_{CP}^{KK}$       
[0.67    , 0.54    , 0.01    , 0.08    , -0.11   , -0.14   , -0.05   , -0.07   , -0.02   , 1.00    , -0.51   , -0.09   , -0.48    ], # 10$A_{ADS(K)}$        
[-0.72   , -0.59   , 0.20    , -0.11   , -0.53   , -0.33   , 0.07    , 0.01    , -0.22   , -0.51   , 1.00    , -0.22   , 0.26     ], # 11$A_{ADS(pi)}$       
[0.15    , 0.21    , 0.17    , 0.10    , -0.03   , 0.01    , -0.13   , 0.13    , 0.50    , -0.09   , -0.22   , 1.00    , 0.33     ], # 12$R_{ADS(K)}$        
[-0.31   , -0.22   , 0.46    , 0.06    , -0.08   , -0.03   , -0.09   , 0.06    , 0.37    , -0.48   , 0.26    , 0.33    , 1.00     ], # 13$R_{ADS(pi)}$
])
print "2-body syst (ANA order)"
printCppMatrix(cor)
print "2-body syst (gammacombo order)"
cor = changeVarOrderInCor(cor,[7, 8, 9, 6, 5, 3, 4, 1, 2, 12, 10, 13, 11])
printCppMatrix(cor)

